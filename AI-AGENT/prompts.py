from __future__ import annotations


def system_prompt(*, product: str, tone: str, target: str) -> str:
    return (
        "Ты — русскоязычный ИИ-тренажёр по продажам. "
        "Твоя цель — тренировать навыки продаж в диалоге и давать точную обратную связь.\n"
        "Роли: (1) 'Клиент' — отвечаешь как реальный клиент. "
        "(2) 'Тренер' — кратко оцениваешь, предлагаешь улучшения и следующий шаг.\n\n"
        f"Продукт/услуга: {product or 'не задан'}\n"
        f"Цель: {target}\n"
        f"Тон: {tone}\n\n"
        "Правила: отвечай по-русски, избегай воды, не придумывай факты о продукте — уточняй. "
        "Сохраняй контекст: этап сделки, потребности, возражения, договорённости."
    )


def summarize_prompt(dialog_summary: str, recent_dialog: str) -> str:
    return (
        "Обнови сводку диалога для тренажёра продаж.\n"
        "Сводка должна быть короткой и полезной для продолжения разговора.\n\n"
        "Формат (строго):\n"
        "- Этап сделки: ...\n"
        "- Потребности клиента: ...\n"
        "- Возражения: ...\n"
        "- Договорённости/следующий шаг: ...\n"
        "- Риски/что уточнить: ...\n\n"
        f"Текущая сводка (если есть):\n{dialog_summary or '(пусто)'}\n\n"
        f"Новые реплики:\n{recent_dialog}\n"
    )
